# 项目1实验报告：Lotka-Volterra捕食者-猎物模型

**学生姓名：** 李欣欣
**学号：** 20221180076
**完成日期：** 2025.5.28
**实验时间：** 4小时

---

## 1. 实验目的

本实验旨在通过数值方法求解Lotka-Volterra捕食者-猎物模型，掌握以下内容：

- 理解生物种群动力学的数学建模方法
- 学习将高阶常微分方程组转换为一阶方程组的标准形式
- 掌握多种数值方法求解常微分方程组（欧拉法、改进欧拉法、4阶龙格-库塔法）
- 比较不同数值方法的精度和稳定性
- 分析生态系统中捕食者与猎物的相互作用规律

## 2. 理论背景

### 2.1 Lotka-Volterra方程组

Lotka-Volterra方程组描述了捕食者与猎物之间的动态关系：

$$
\begin{cases}
\frac{dx}{dt} = \alpha x - \beta xy \\
\frac{dy}{dt} = \gamma xy - \delta y
\end{cases}
$$

参数生物学意义：
- x: 猎物种群数量
- y: 捕食者种群数量
- α: 猎物自然增长率
- β: 捕食效率
- γ: 捕食者从猎物获得的增长效率
- δ: 捕食者自然死亡率

### 2.2 数值方法原理

**欧拉法：**
最简单的数值方法，使用当前点的导数近似计算下一步的值：

$$
y_{n+1} = y_n + hf(t_n, y_n)
$$

优点是计算简单，但精度较低。

**改进欧拉法：**
使用当前点和预测点的平均斜率：

$$
y_{n+1} = y_n + \frac{h}{2}(f(t_n, y_n) + f(t_{n+1}, y_n + hf(t_n, y_n)))
$$

精度比欧拉法高，但仍有限。

**4阶龙格-库塔法：**
通过计算四个中间斜率来获得更高精度：

$$
\begin{aligned}
k_1 &= hf(t_n, y_n) \\
k_2 &= hf(t_n + h/2, y_n + k_1/2) \\
k_3 &= hf(t_n + h/2, y_n + k_2/2) \\
k_4 &= hf(t_n + h, y_n + k_3) \\
y_{n+1} &= y_n + (k_1 + 2k_2 + 2k_3 + k_4)/6
\end{aligned}
$$

计算量较大但精度高，稳定性好。

## 3. 实验方法与实现

### 3.1 参数设置

根据题目要求，本实验使用以下参数：

- 模型参数：α = 1.0, β = 0.5, γ = 0.5, δ = 2.0
- 初始条件：x₀ = 2.0, y₀ = 2.0
- 时间范围：t ∈ [0, 30]
- 时间步长：dt = 0.01

### 3.2 核心算法实现

```python
def lotka_volterra_system(state, t, alpha, beta, gamma, delta):
    x, y = state
    dxdt = alpha * x - beta * x * y
    dydt = gamma * x * y - delta * y
    return np.array([dxdt, dydt])

def runge_kutta_4(f, y0, t_span, dt, *args):
    t_start, t_end = t_span
    t = np.arange(t_start, t_end + dt, dt)
    n_steps = len(t)
    n_vars = len(y0)
    
    y = np.zeros((n_steps, n_vars))
    y[0] = y0
    
    for i in range(n_steps - 1):
        k1 = dt * f(y[i], t[i], *args)
        k2 = dt * f(y[i] + k1/2, t[i] + dt/2, *args)
        k3 = dt * f(y[i] + k2/2, t[i] + dt/2, *args)
        k4 = dt * f(y[i] + k3, t[i] + dt, *args)
        y[i+1] = y[i] + (k1 + 2*k2 + 2*k3 + k4)/6
    
    return t, y
```

### 3.3 实现过程中遇到的问题

1. **数值不稳定问题**：
   使用欧拉法时，当步长较大时会出现数值发散。通过减小步长到0.01解决了此问题。

2. **守恒量误差**：
   发现欧拉法计算的守恒量随时间漂移明显。改用RK4方法后，守恒量保持得更好。

3. **绘图显示问题**：
   最初绘图时中文显示为方框。通过设置matplotlib字体参数解决了此问题。

## 4. 实验结果

### 4.1 基本求解结果

![image](https://github.com/user-attachments/assets/5b527cf3-bf80-4883-8b63-3b5ef88fd096)


**观察结果描述：**
- 猎物和捕食者数量呈现周期性振荡
- 猎物数量峰值先于捕食者数量峰值
- 相空间轨迹为闭合曲线，表明系统存在周期性解
- 猎物数量变化幅度大于捕食者

### 4.2 数值方法比较

![image](https://github.com/user-attachments/assets/58cc02b0-dab9-43c1-aec9-aa1fb66e73ae)


**比较结果分析：**

| 方法 | 计算精度 | 计算效率 | 稳定性 | 守恒量误差 |
|------|----------|----------|--------|------------|
| 欧拉法 | 低 | 高 | 差 | 大 |
| 改进欧拉法 | 中 | 中 | 中 | 中 |
| 4阶RK法 | 高 | 低 | 好 | 小 |

### 4.3 参数影响分析

![image](https://github.com/user-attachments/assets/312d3d4d-7be2-4205-ac89-e54f20a17a5f)


**参数敏感性分析：**
- 初始条件影响振荡的振幅和相位
- 猎物初始数量增加导致捕食者峰值延迟
- 捕食者初始数量增加导致猎物数量更快下降
- 系统对初始条件敏感但不改变基本周期特性

## 5. 结果分析与讨论

### 5.1 生物学意义分析

**种群动力学特征：**
- 猎物数量增加导致捕食者食物充足而增长
- 捕食者数量增加导致猎物被捕食压力增大
- 猎物减少后捕食者因食物短缺而减少
- 捕食者减少后猎物得以恢复，形成循环

**相互作用机制：**
- 捕食者数量变化滞后于猎物约1/4周期
- 这种相位差是维持周期性振荡的关键
- 系统存在负反馈调节机制

**生态平衡：**
- 系统在无外界干扰下保持动态平衡
- 周期性振荡表明系统具有自我调节能力
- 实际生态系统中这种理想周期性较少见

### 5.2 数值方法评估

**精度比较：**
- 欧拉法误差累积明显，振幅逐渐增大
- 改进欧拉法精度提高但仍存在相位误差
- RK4法精度最高，守恒量保持最好

**计算效率：**
- 欧拉法计算速度最快
- RK4法因需计算4次函数值而较慢
- 对于长期模拟，RK4法因可采取更大步长而效率提升

**适用性分析：**
- 快速估算可使用欧拉法
- 一般精度要求可用改进欧拉法
- 高精度要求必须使用RK4法
- 长期模拟建议使用RK4法

## 6. 思考题

### 6.1 周期性分析
**问题：** 为什么Lotka-Volterra系统会表现出周期性行为？这种周期性在现实生态系统中是否存在？

**回答：**
周期性源于捕食者与猎物的相互作用机制：猎物增长→捕食者增长→猎物减少→捕食者减少→猎物恢复的循环。现实生态系统中，这种理想周期性很少见，因为实际系统受更多因素影响（环境变化、多物种相互作用、随机因素等），但类似的振荡现象确实存在。

**实验报告完成情况自评：**

- [*] 完成了所有必需的函数实现
- [*] 通过了所有测试用例
- [*] 生成了所有要求的图表
- [*] 完成了结果分析和讨论
- [*] 回答了所有思考题

**总体评价：** 本实验成功实现了Lotka-Volterra模型的数值求解，验证了其周期性特征，比较了不同数值方法的性能。结果表明RK4法最适合此类问题的求解，而模型虽然简化，但很好地揭示了捕食者-猎物相互作用的基本原理。

**建议成绩：** 100 / 100分
