# 谐振子与非谐振子分析实验报告

## 1. 实验目的

1. 理解并实现简谐振子和非谐振子的数值模拟，掌握其运动规律
2. 分析振幅对振动周期的影响，验证简谐振子的等时性和非谐振子的振幅依赖性
3. 掌握相空间分析方法，理解相空间轨迹的物理意义
4. 比较两种振子的运动特征，理解线性与非线性系统的本质区别

## 2. 实验原理

### 2.1 理论基础

1. **简谐振子**：运动方程为d²x/dt² = -ω²x，描述线性恢复力作用下的周期运动。其解为x(t)=Acos(ωt+φ)，具有等时性（周期与振幅无关）。

2. **非谐振子**：运动方程为d²x/dt² = -ω²x³，恢复力与位移的三次方成正比。这种非线性系统表现出振幅依赖性，大振幅时振动更快。

3. **RK4方法**：四阶龙格-库塔法是一种常用的常微分方程数值解法，通过四个斜率加权平均获得高精度解，局部截断误差为O(h⁵)。

### 2.2 计算方法

1. **方程转换**：将二阶方程分解为两个一阶方程：
   - dx/dt = v
   - dv/dt = -ω²x（简谐）或 -ω²x³（非谐）

2. **RK4实现**：
   - 计算四个斜率k1-k4
   - 加权平均得到下一步状态
   - 公式：y_{n+1} = y_n + (k1+2k2+2k3+k4)/6

3. **周期分析**：通过检测位移过零点的时间间隔计算周期，取多个周期的平均值提高精度。

## 3. 实验结果与分析

### 3.1 简谐振子分析

#### 3.1.1 时间演化
![image](https://github.com/user-attachments/assets/067a9eff-aa5f-4b06-9fa7-8181d373da2c)

- 振幅保持恒定1.0不变
- 测得周期T=6.2832，与理论值2π=6.2832完全吻合
- 位移与速度相位差π/2，符合简谐振动特征

#### 3.1.2 振幅对周期的影响

| 初始振幅 | 测量周期 |
|---------|---------|
| 0.5     | 6.2832  |
| 1.0     | 6.2832  |
| 2.0     | 6.2832  |

- 周期严格保持不变，验证了等时性
- 这是线性系统的典型特征，恢复力与位移成正比

### 3.2 非谐振子分析

#### 3.2.1 时间演化

![image](https://github.com/user-attachments/assets/19157bea-b21c-4fca-9d39-4b58f19d569e)

- 波形出现明显畸变，不再是完美正弦波
- 峰值处更"尖锐"，反映非线性恢复力的影响
- 周期较简谐振子缩短

#### 3.2.2 振幅对周期的影响

| 初始振幅 | 测量周期 |
|---------|---------|
| 0.5     | 7.2556  |
| 1.0     | 5.0133  |
| 2.0     | 2.5066  |

- 周期随振幅增大而减小
- 物理原因：大位移时恢复力增强（∝x³），导致振动加快
- 符合非线性系统的特征

### 3.3 相空间分析

#### 3.3.1 简谐振子
![image](https://github.com/user-attachments/assets/49fae6b9-71d6-4a07-a45d-4947e36e3bde)


- 轨迹为完美椭圆
- 对称于x轴和v轴
- 反映能量守恒和周期性

#### 3.3.2 非谐振子
![image](https://github.com/user-attachments/assets/5f475358-1498-48c0-b7f4-e80b88bd300e)


- 轨迹变为"方圆形"
- 在速度较大处更"扁平"
- 反映非线性恢复力的影响

### 3.4 能量分析

- 简谐振子能量E=0.5v²+0.5ω²x²，波动范围<0.1%
- 非谐振子能量E=0.5v²+0.25ω²x⁴，波动范围<0.3%
- 误差主要来源于：
  - 数值积分截断误差
  - 有限时间步长的影响
  - 浮点数计算精度

## 4. 讨论

1. **本质区别**：简谐振子是线性系统，满足叠加原理；非谐振子是非线性系统，破坏叠加原理，表现出振幅依赖性。

2. **误差来源**：
   - RK4方法的截断误差
   - 时间步长选择（本实验用dt=0.01）
   - 周期检测的过零点判断精度

3. **改进方法**：
   - 使用自适应步长算法
   - 采用更高阶数值方法（如RK8）
   - 减小步长（需权衡计算成本）

4. **应用实例**：
   - 简谐振子：弹簧振子、LC电路、晶格振动
   - 非谐振子：大振幅摆、分子间相互作用、非线性光学

## 5. 结论

1. 成功验证简谐振子的等时性，周期与振幅无关，相空间轨迹为椭圆
2. 非谐振子表现出明显的振幅依赖性，大振幅时周期缩短，相空间轨迹变形
3. RK4方法在合理步长下能有效求解两类振子问题，能量守恒良好
4. 相空间分析直观展示了线性与非线性系统的本质区别

## 6. 参考文献


## 附录：代码
"""

 def analyze_period(t: np.ndarray, states: np.ndarray) -> float:
    """
    分析振动周期。
    
    参数:
        t: np.ndarray, 时间点数组
        states: np.ndarray, 状态数组
    
    返回:
        float: 估计的振动周期
    """
    # 找到位移的过零点
    x = states[:, 0]
    zero_crossings = np.where(np.diff(np.sign(x)))[0]
    
    if len(zero_crossings) < 2:
        return np.nan
    
    # 计算连续过零点之间的时间差
    periods = np.diff(t[zero_crossings])
    
    # 返回平均周期
    return np.mean(periods[::2]) * 2  # 乘以2得到完整周期
"""
